**** DELETE INTERNAL TABLE WHERE CONTAINTS****
**** FİLTRE UYGULANMASI EKRANIN ÖN YÜZÜNDE.

SELECTION-SCREEN BEGIN OF BLOCK B2 WITH FRAME TITLE TEXT-002              .
 SELECT-OPTIONS : S_ANKETT   FOR CRMS4D_SERV_H-POSTING_DATE.

 PARAMETERS     : P_ANKET1   TYPE STRING,
                  P_ANKTIP   TYPE STRING,
                  P_SAHIBI   TYPE EMNAME.

SELECTION-SCREEN END OF BLOCK B2.


IF S_ANKETT[] IS NOT INITIAL.
  RANGES : R_TARH FOR LS_SURVEY_RAPOR-ANKET_TAR.
  CLEAR : R_TARH.
  CONCATENATE S_ANKETT-LOW+6(2)'.'S_ANKETT-LOW+4(2)'.'S_ANKETT-LOW(4)
        INTO  R_TARH-LOW.
  R_TARH-HIGH = S_ANKETT-HIGH.
  R_TARH-SIGN = S_ANKETT-SIGN.
  R_TARH-OPTION = S_ANKETT-OPTION.
  APPEND R_TARH.
   DELETE LT_SURVEY_RAPOR WHERE ANKET_TAR  NOT IN R_TARH.
ENDIF.

IF S_BOLGE[] IS NOT INITIAL.
   DELETE LT_SURVEY_RAPOR WHERE BOLGE NOT IN S_BOLGE.
ENDIF.

IF P_ANKET1 IS NOT INITIAL.
  RANGES : R_ANT1 FOR LS_SURVEY_RAPOR-ANKET1.
   CLEAR  : R_ANT1.
   LOOP AT LT_SURVEY_RAPOR INTO LS_SURVEY_RAPOR.
           R_ANT1-SIGN   = 'I'.
           R_ANT1-OPTION = 'CP'.
           CONCATENATE '*' P_ANKET1 '*' INTO R_ANT1-LOW.
           APPEND R_ANT1.
   ENDLOOP.

   DELETE LT_SURVEY_RAPOR WHERE ANKET1 NOT IN R_ANT1.
ENDIF.

IF P_ANKTIP IS NOT INITIAL.
  RANGES : R_ANTP FOR LS_SURVEY_RAPOR-ANKET1.
   CLEAR  : R_ANTP.
   LOOP AT LT_SURVEY_RAPOR INTO LS_SURVEY_RAPOR.
           R_ANTP-SIGN   = 'I'.
           R_ANTP-OPTION = 'CP'.
           CONCATENATE '*' P_ANKET1 '*' INTO R_ANTP-LOW.
           APPEND R_ANT1.
   ENDLOOP.
   DELETE LT_SURVEY_RAPOR WHERE ANKETTIP NOT IN R_ANTP.
ENDIF.

IF P_SAHIBI IS NOT INITIAL.
   RANGES : R_SAHB FOR LS_SURVEY_RAPOR-SAHIBI.
   CLEAR  : R_SAHB.
   LOOP AT LT_SURVEY_RAPOR INTO LS_SURVEY_RAPOR.
       R_SAHB-SIGN   = 'I'.
       R_SAHB-OPTION = 'CP'.
       CONCATENATE '*' P_SAHIBI '*' INTO R_SAHB-LOW.
       APPEND R_SAHB.
   ENDLOOP.
   DELETE LT_SURVEY_RAPOR WHERE SAHIBI NOT IN R_SAHB.
ENDIF.
